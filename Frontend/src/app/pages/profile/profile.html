<div class="profile-page">
  <div class="container">
    <!-- Page Header -->
    <div class="page-header">
      <h1>My Dashboard</h1>
      <p>Welcome back! Here's what's happening with your account.</p>
    </div>

    <!-- States -->
    <div *ngIf="loading" class="mt-3">Loading profile...</div>
    <div *ngIf="!loading && error" class="mt-3" style="color:#ef4444">{{ error }}</div>

    <ng-container *ngIf="!loading && !error">
      <!-- Profile Header -->
      <section class="profile-header">
        <div class="profile-info">
          <div class="profile-avatar">
            <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=3840&h=2160&fit=crop&crop=center" alt="User Avatar">
          </div>
          <div class="profile-details">
            <h1>{{ (user?.nom || '') + ' ' + (user?.['prénom'] || '') }}</h1>
            <p class="user-email">{{ user?.email }}</p>
            <p class="member-since" *ngIf="user?.['createdAt']">Member since {{ user?.['createdAt'] | date }}</p>
            <div class="profile-stats">
              <div class="stat">
                <span class="stat-number">{{ user?.['ordersCount'] || 0 }}</span>
                <span class="stat-label">Orders</span>
              </div>
              <div class="stat">
                <span class="stat-number">{{ user?.['wishlistCount'] || 0 }}</span>
                <span class="stat-label">Wishlist</span>
              </div>
              <div class="stat">
                <span class="stat-number">{{ user?.['rating'] || '—' }}</span>
                <span class="stat-label">Rating</span>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Simplified Profile Content - Only Dashboard Overview -->
      <section class="profile-content">
        <!-- Dashboard Overview Tab (now the only content) -->
        <div class="tab-content active">
          <div class="overview-grid">
            <div class="overview-card">
              <div class="card-header">
                <h3>Recent Orders</h3>
                <a routerLink="/my-orders" class="view-all-link">View All Orders</a>
              </div>
              <div *ngIf="ordersLoading" class="loading-orders">
                Loading orders...
              </div>
              <div *ngIf="ordersError" class="error-orders">
                {{ ordersError }}
              </div>
              <div class="recent-orders" *ngIf="!ordersLoading && !ordersError && user?.['recentOrders']?.length; else noOrders">
                <div class="order-item" *ngFor="let o of user?.['recentOrders']">
                  <div class="order-image">
                    <img [src]="o.imageUrl" alt="Order">
                  </div>
                  <div class="order-info">
                    <h4>{{ o.title }}</h4>
                    <p class="order-date">Ordered on {{ o.date | date }}</p>
                    <span class="order-status" [class]="'status-' + (o.status?.toLowerCase() || 'pending')">{{ o.status }}</span>
                  </div>
                  <div class="order-price">${{ o.total?.toFixed(2) || '0.00' }}</div>
                </div>
              </div>
              <ng-template #noOrders>
                <p>No recent orders.</p>
                <a routerLink="/products" class="shop-link">Start Shopping</a>
              </ng-template>
            </div>

            <div class="overview-card">
              <h3>Account Summary</h3>
              <div class="account-summary">
                <div class="summary-item">
                  <span class="summary-label">Full Name</span>
                  <span class="summary-value">{{ (user?.nom || '') + ' ' + (user?.['prénom'] || '') }}</span>
                </div>
                <div class="summary-item">
                  <span class="summary-label">Email</span>
                  <span class="summary-value">{{ user?.email }}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </ng-container>
  </div>
</div>
