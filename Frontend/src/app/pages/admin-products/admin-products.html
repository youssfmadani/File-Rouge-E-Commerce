<div class="admin-products">
  <!-- Header -->
  <div class="page-header">
    <div class="header-left">
      <button class="btn btn-secondary" (click)="goBack()">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M19 12H5M12 19l-7-7 7-7"/>
        </svg>
        Back to Dashboard
      </button>
      <h1>Product Management</h1>
      <p>Manage your store's product catalog</p>
    </div>
    <div class="header-right">
      <button class="btn btn-primary" (click)="showAddProductForm()">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 5v14M5 12h14"/>
        </svg>
        Add Product
      </button>
    </div>
  </div>

  <!-- Messages -->
  <div *ngIf="successMessage" class="message success">
    {{ successMessage }}
  </div>
  <div *ngIf="errorMessage" class="message error">
    {{ errorMessage }}
  </div>

  <!-- Filters -->
  <div class="filters-section">
    <div class="filters">
      <div class="search-filter">
        <input 
          type="text" 
          placeholder="Search products..."
          [(ngModel)]="searchTerm"
          (input)="onSearchChange()"
          class="search-input"
        >
      </div>
      <div class="category-filter">
        <select 
          [(ngModel)]="selectedCategory"
          (change)="onCategoryChange()"
          class="category-select"
        >
          <option value="">All Categories</option>
          <option *ngFor="let category of categories" [value]="category">{{ category }}</option>
        </select>
      </div>
    </div>
  </div>

  <!-- Products Table -->
  <div class="products-section">
    <div *ngIf="isLoading" class="loading-state">
      <div class="spinner"></div>
      <span>Loading products...</span>
    </div>

    <div *ngIf="!isLoading" class="products-table">
      <div class="table-header">
        <div class="header-cell">Product</div>
        <div class="header-cell">Category</div>
        <div class="header-cell">Price</div>
        <div class="header-cell">Stock</div>
        <div class="header-cell">Actions</div>
      </div>
      
      <div *ngFor="let product of filteredProducts" class="table-row">
        <div class="cell product-cell">
          <div class="product-info">
            <img 
              [src]="product.imageUrl || 'https://images.unsplash.com/photo-1505740420928-5e560c06d30e?w=60&h=60&fit=crop'"
              [alt]="getProductTitle(product)"
              class="product-image"
            >
            <div class="product-details">
              <h4>{{ getProductTitle(product) }}</h4>
              <p>{{ product.description || 'No description available' }}</p>
            </div>
          </div>
        </div>
        <div class="cell">{{ getProductCategory(product) }}</div>
        <div class="cell">${{ getProductPrice(product) }}</div>
        <div class="cell">{{ product.stock || 0 }}</div>
        <div class="cell actions-cell">
          <button class="btn btn-sm btn-outline" (click)="editProduct(product)">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
              <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
            </svg>
            Edit
          </button>
          <button class="btn btn-sm btn-danger" (click)="deleteProduct(product)">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="3,6 5,6 21,6"/>
              <path d="M19,6v14a2,2,0,0,1-2,2H7a2,2,0,0,1-2-2V6m3,0V4a2,2,0,0,1,2-2h4a2,2,0,0,1,2,2V6"/>
            </svg>
            Delete
          </button>
        </div>
      </div>
      
      <div *ngIf="filteredProducts.length === 0 && !isLoading" class="empty-state">
        <h3>No products found</h3>
        <p>Try adjusting your search criteria or add your first product.</p>
      </div>
    </div>
  </div>

  <!-- Add/Edit Product Modal -->
  <div *ngIf="showAddForm" class="modal-overlay" (click)="hideAddForm()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>{{ editingProduct ? 'Edit Product' : 'Add New Product' }}</h2>
        <button class="close-btn" (click)="hideAddForm()">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </div>
      
      <form class="product-form" (ngSubmit)="saveProduct()">
        <div class="form-grid">
          <div class="form-group">
            <label for="title">Product Name *</label>
            <input 
              type="text" 
              id="title" 
              [(ngModel)]="newProduct.title" 
              name="title"
              required
              class="form-input"
            >
          </div>
          
          <div class="form-group">
            <label for="category">Category *</label>
            <select 
              id="category" 
              [(ngModel)]="newProduct.category" 
              name="category"
              required
              class="form-input"
            >
              <option value="">Select Category</option>
              <option *ngFor="let category of categories" [value]="category">{{ category }}</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="price">Price *</label>
            <input 
              type="number" 
              id="price" 
              [(ngModel)]="newProduct.price" 
              name="price"
              min="0"
              step="0.01"
              required
              class="form-input"
            >
          </div>
          
          <div class="form-group">
            <label for="stock">Stock Quantity</label>
            <input 
              type="number" 
              id="stock" 
              [(ngModel)]="newProduct.stock" 
              name="stock"
              min="0"
              class="form-input"
            >
          </div>
        </div>
        
        <div class="form-group full-width">
          <label for="description">Description</label>
          <textarea 
            id="description" 
            [(ngModel)]="newProduct.description" 
            name="description"
            rows="3"
            class="form-input"
          ></textarea>
        </div>
        
        <div class="form-group full-width">
          <label for="imageUrl">Image URL</label>
          <input 
            type="url" 
            id="imageUrl" 
            [(ngModel)]="newProduct.imageUrl" 
            name="imageUrl"
            class="form-input"
            placeholder="https://example.com/image.jpg"
          >
        </div>
        
        <div class="form-actions">
          <button type="button" class="btn btn-secondary" (click)="hideAddForm()">Cancel</button>
          <button type="submit" class="btn btn-primary">
            {{ editingProduct ? 'Update Product' : 'Add Product' }}
          </button>
        </div>
      </form>
    </div>
  </div>
</div>